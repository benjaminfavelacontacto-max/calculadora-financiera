<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Calculadora Interés Compuesto | Benjamin Favela</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
    body {
        font-family: 'Segoe UI', sans-serif;
        background: linear-gradient(135deg,#000000,#0a0a0a);
        color: #f5d27a;
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        margin: 0;
        padding: 20px;
    }
    .container {
        background: #111111;
        padding: 35px;
        border-radius: 20px;
        width: 720px;
        box-shadow: 0 0 40px rgba(212,175,55,0.4);
        border: 1px solid #d4af37;
    }
    h2 {
        text-align: center;
        margin-bottom: 25px;
        font-weight: 700;
        letter-spacing: 1px;
        color: #d4af37;
    }
    input, select {
        width: 100%;
        padding: 12px;
        margin: 8px 0;
        border-radius: 10px;
        border: 1px solid #d4af37;
        background: #000000;
        color: #f5d27a;
        font-size: 15px;
    }

    .input-money {
        position: relative;
    }

    .input-money span {
        position: absolute;
        left: 12px;
        top: 50%;
        transform: translateY(-50%);
        color: #d4af37;
        font-weight: bold;
        transition: all 0.3s ease;
        text-shadow: 0 0 0px #d4af37;
    }

    .input-money input:focus + span,
    .input-money input:focus ~ span {
        color: #ffd700;
        text-shadow: 0 0 8px #ffd700, 0 0 16px rgba(255,215,0,0.6);
    }

    .input-money:focus-within span {
        color: #ffd700;
        text-shadow: 0 0 8px #ffd700, 0 0 16px rgba(255,215,0,0.6);
    }

    .input-money input {
        padding-left: 28px;
    }
    button {
        width: 100%;
        padding: 14px;
        margin-top: 10px;
        border-radius: 10px;
        border: none;
        background: #d4af37;
        color: black;
        font-weight: bold;
        cursor: pointer;
        font-size: 15px;
        transition: 0.3s;
    }
    button:hover { background: #b8962e; }
    .resumen {
        margin-top: 20px;
        font-size: 14px;
        line-height: 1.7;
        background: #000000;
        padding: 18px;
        border-radius: 14px;
        border: 1px solid #d4af37;
    }
    canvas { margin-top: 30px; }
</style>
</head>
<body>

<div class="container">
    <h2>Calculadora Interés Simple vs Compuesto</h2>

    <label>Capital inicial</label>
    <div class="input-money">
        <span>$</span>
        <input type="text" inputmode="decimal" id="capital" placeholder="10,000.00">
    </div>

    <label>Aportación periódica</label>
    <div class="input-money">
        <span>$</span>
        <input type="text" inputmode="decimal" id="aportacion" placeholder="1,000.00">
    </div>

    <label>Tasa de interés anual (%)</label>
    <input type="number" id="tasa" placeholder="Ej. 10">

    <label>Años a invertir</label>
    <input type="number" id="años" placeholder="Ej. 20">

    <label>Frecuencia de capitalización</label>
    <select id="frecuencia">
        <option value="1">Anual</option>
        <option value="12">Mensual</option>
        <option value="52">Semanal</option>
    </select>

    <label>Inflación anual (%)</label>
    <input type="text" inputmode="decimal" id="inflacion" placeholder="Ej. 6">

    <label>Meta financiera</label>
    <div class="input-money">
        <span>$</span>
        <input type="text" inputmode="decimal" id="meta" placeholder="1,000,000.00">
    </div>

    <button id="btnCalcular">Calcular</button>
    
    <div class="resumen" id="resumen"></div>
    <div id="cards" style="display:flex;gap:15px;margin-top:20px;flex-wrap:wrap;"></div>

    <canvas id="grafica"></canvas>

    <div style="margin-top:30px;max-height:300px;overflow-y:auto;border:1px solid #d4af37;border-radius:12px;">
        <table id="tablaResultados" style="width:100%;border-collapse:collapse;font-size:13px;">
            <thead style="background:#000;color:#d4af37;position:sticky;top:0;">
                <tr>
                    <th style="padding:8px;border-bottom:1px solid #d4af37;">Año</th>
                    <th style="padding:8px;border-bottom:1px solid #d4af37;">Total Simple</th>
                    <th style="padding:8px;border-bottom:1px solid #d4af37;">Total Compuesto</th>
                </tr>
            </thead>
            <tbody style="text-align:center;background:#111;"></tbody>
        </table>
    </div>
</div>

<script>
let chart = null;

function formatoMoneda(valor){
    return "$" + Number(valor).toLocaleString('es-MX', {minimumFractionDigits:2, maximumFractionDigits:2});
}

function limpiarNumero(valor){
    return parseFloat(valor.replace(/,/g,'')) || 0;
}

function formatearInput(input){
    input.addEventListener('input', function(e){
        let valor = e.target.value.replace(/,/g,'');
        if(valor === '') return;
        if(!isNaN(valor)){
            const numero = parseFloat(valor);
            e.target.value = numero.toLocaleString('en-US', {maximumFractionDigits:2});
        }
    });
}

function calcular() {
    const capital = limpiarNumero(document.getElementById("capital").value);
    const aportacion = limpiarNumero(document.getElementById("aportacion").value);
    const tasaAnual = (parseFloat(document.getElementById("tasa").value) || 0) / 100;
    const años = parseInt(document.getElementById("años").value) || 0;
    const frecuencia = parseInt(document.getElementById("frecuencia").value);
    const inflacionAnual = limpiarNumero(document.getElementById("inflacion").value) / 100;
    const meta = limpiarNumero(document.getElementById("meta").value);

    if (capital <= 0 || tasaAnual <= 0 || años <= 0) {
        alert("Completa capital, tasa y años correctamente");
        return;
    }

    const periodos = años * frecuencia;
    const tasaPeriodo = tasaAnual / frecuencia;

    let simple = capital;
    let compuesto = capital;

    const simpleData = [];
    const compuestoData = [];
    const labels = [];
    const tabla = [];

    for (let i = 0; i <= periodos; i++) {
        if (i > 0) {
            simple += capital * tasaPeriodo;
            simple += aportacion;

            compuesto = (compuesto + aportacion) * (1 + tasaPeriodo);
        }

        if (i % frecuencia === 0) {
            const añoActual = i / frecuencia;
            labels.push("Año " + añoActual);
            simpleData.push(simple);
            compuestoData.push(compuesto);
            tabla.push({
                año: añoActual,
                simple: simple,
                compuesto: compuesto
            });
        }
    }

    const aportacionesTotales = aportacion * periodos;
    const invertidoTotal = capital + aportacionesTotales;
    const interesAcumulado = compuesto - invertidoTotal;
    const interesSimpleGanado = simple - invertidoTotal;
    const diferencia = compuesto - simple;

    let rendimientoReal = 0;
    if (inflacionAnual > 0) {
        rendimientoReal = ((1 + tasaAnual) / (1 + inflacionAnual)) - 1;
    }

    let añoSuperaAportaciones = null;
    let añoMetaAlcanzada = null;

    for (let i = 0; i < tabla.length; i++) {
        const aportadoHastaEseMomento = capital + (aportacion * (tabla[i].año * frecuencia));
        const interesHastaEseMomento = tabla[i].compuesto - aportadoHastaEseMomento;

        if (añoSuperaAportaciones === null && interesHastaEseMomento > (aportacion * (tabla[i].año * frecuencia))) {
            añoSuperaAportaciones = tabla[i].año;
        }

        if (meta > 0 && añoMetaAlcanzada === null && tabla[i].compuesto >= meta) {
            añoMetaAlcanzada = tabla[i].año;
        }
    }

    document.getElementById("resumen").innerHTML = `
        <strong>Total invertido:</strong> ${formatoMoneda(invertidoTotal)}<br>
        <strong>Interés ganado (simple):</strong> ${formatoMoneda(interesSimpleGanado)}<br>
        <strong>Interés ganado (compuesto):</strong> ${formatoMoneda(interesAcumulado)}<br>
        <strong>Diferencia a favor del compuesto:</strong> ${formatoMoneda(diferencia)}<br>
        ${inflacionAnual > 0 ? `<strong>Rendimiento real anual estimado:</strong> ${(rendimientoReal*100).toFixed(2)}%<br>` : ``}
        ${añoSuperaAportaciones !== null ? `<strong>El interés supera tus aportaciones en el año:</strong> ${añoSuperaAportaciones}<br>` : ``}
        ${meta > 0 ? (añoMetaAlcanzada !== null ? `<strong>Meta alcanzada en el año:</strong> ${añoMetaAlcanzada}` : `<strong>No se alcanza la meta en el periodo seleccionado</strong>`) : ``}
    `;

    const porcentajeCapital = (capital / compuesto) * 100;
    const porcentajeAportaciones = (aportacionesTotales / compuesto) * 100;
    const porcentajeInteres = (interesAcumulado / compuesto) * 100;

    document.getElementById("cards").innerHTML = `
        <div style="flex:1;background:#000;padding:15px;border-radius:12px;border:1px solid #d4af37;text-align:center;">
            <div>Aportaciones periódicas acumuladas</div>
            <h3>${formatoMoneda(aportacionesTotales)}</h3>
        </div>
        <div style="flex:1;background:#000;padding:15px;border-radius:12px;border:1px solid #00bcd4;text-align:center;">
            <div>Total final interés simple</div>
            <h3>${formatoMoneda(simple)}</h3>
        </div>
        <div style="flex:1;background:#000;padding:15px;border-radius:12px;border:1px solid #ff6b35;text-align:center;">
            <div>Total final interés compuesto</div>
            <h3>${formatoMoneda(compuesto)}</h3>
        </div>
        <div style="flex-basis:100%;background:#000;padding:15px;border-radius:12px;border:1px solid #d4af37;margin-top:10px;">
            <div style="margin-bottom:8px;text-align:center;">Composición del total final (Compuesto)</div>
            <div style="height:18px;background:#111;border-radius:10px;overflow:hidden;display:flex;">
                <div style="width:${porcentajeCapital}%;background:#d4af37;"></div>
                <div style="width:${porcentajeAportaciones}%;background:#00bcd4;"></div>
                <div style="width:${porcentajeInteres}%;background:#ff6b35;"></div>
            </div>
            <div style="display:flex;justify-content:space-between;font-size:12px;margin-top:6px;">
                <span>Capital</span>
                <span>Aportaciones</span>
                <span>Interés</span>
            </div>
        </div>
    `;

    const tbody = document.querySelector('#tablaResultados tbody');
    tbody.innerHTML = '';
    tabla.forEach(fila => {
        tbody.innerHTML += `
            <tr>
                <td style="padding:6px;border-bottom:1px solid #222;">${fila.año}</td>
                <td style="padding:6px;border-bottom:1px solid #222;color:#00bcd4;">${formatoMoneda(fila.simple)}</td>
                <td style="padding:6px;border-bottom:1px solid #222;color:#ff6b35;">${formatoMoneda(fila.compuesto)}</td>
            </tr>
        `;
    });

    if (chart) chart.destroy();

    const ctx = document.getElementById("grafica").getContext("2d");
    chart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: labels,
            datasets: [
                {
                    label: 'Interés Simple ($)',
                    data: simpleData,
                    borderColor: '#00bcd4',
                    borderWidth: 3,
                    tension: 0.3
                },
                {
                    label: 'Interés Compuesto ($)',
                    data: compuestoData,
                    borderColor: '#ff6b35',
                    borderWidth: 4,
                    tension: 0.3
                }
            ]
        },
        options: {
            responsive: true,
            scales: {
                y: {
                    ticks: {
                        callback: value => '$' + value.toLocaleString()
                    }
                }
            }
        }
    });
}

window.addEventListener('DOMContentLoaded', function() {
    document.getElementById('btnCalcular').addEventListener('click', calcular);

    formatearInput(document.getElementById('capital'));
    formatearInput(document.getElementById('aportacion'));
    formatearInput(document.getElementById('inflacion'));
    formatearInput(document.getElementById('meta'));
});
</script>

</body>
</html>

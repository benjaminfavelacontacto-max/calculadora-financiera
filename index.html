<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Calculadora Inter√©s Compuesto | Benjamin Favela</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
    body {
        font-family: 'Segoe UI', sans-serif;
        background: linear-gradient(135deg,#000000,#0a0a0a);
        color: #f5d27a;
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        margin: 0;
        padding: 20px;
    }
    .container {
        background: #111111;
        padding: 35px;
        border-radius: 20px;
        width: 720px;
        max-width: 100%;
        box-sizing: border-box;
        box-shadow: 0 0 40px rgba(212,175,55,0.4);
        border: 1px solid #d4af37;
    }
    h2 {
        text-align: center;
        margin-bottom: 25px;
        font-weight: 700;
        letter-spacing: 1px;
        color: #d4af37;
    }
    input, select {
        width: 100%;
        padding: 12px;
        margin: 8px 0;
        border-radius: 10px;
        border: 1px solid #d4af37;
        background: #000000;
        color: #f5d27a;
        font-size: 15px;
        box-sizing: border-box;
    }

    .input-money {
        position: relative;
    }

    .input-money span {
        position: absolute;
        left: 12px;
        top: 50%;
        transform: translateY(-50%);
        color: #d4af37;
        font-weight: bold;
        transition: all 0.3s ease;
        text-shadow: 0 0 0px #d4af37;
    }

    .input-money input:focus + span,
    .input-money input:focus ~ span {
        color: #ffd700;
        text-shadow: 0 0 8px #ffd700, 0 0 16px rgba(255,215,0,0.6);
    }

    .input-money:focus-within span {
        color: #ffd700;
        text-shadow: 0 0 8px #ffd700, 0 0 16px rgba(255,215,0,0.6);
    }

    .input-money input {
        padding-left: 28px;
    }
    button {
        width: 100%;
        padding: 14px;
        margin-top: 10px;
        border-radius: 10px;
        border: none;
        background: #d4af37;
        color: black;
        font-weight: bold;
        cursor: pointer;
        font-size: 15px;
        transition: 0.3s;
    }
    button:hover { background: #b8962e; }
    .resumen {
        margin-top: 20px;
        font-size: 14px;
        line-height: 1.7;
        background: #000000;
        padding: 18px;
        border-radius: 14px;
        border: 1px solid #d4af37;
    }
    canvas { margin-top: 30px; }
</style>
</head>
<body>

<div class="container">
    <h2>Calculadora Inter√©s Simple vs Compuesto</h2>

    <label>Capital inicial</label>
    <div class="input-money">
        <span>$</span>
        <input type="text" inputmode="decimal" id="capital" placeholder="10,000.00">
    </div>

    <label>Aportaci√≥n peri√≥dica</label>
    <div class="input-money">
        <span>$</span>
        <input type="text" inputmode="decimal" id="aportacion" placeholder="1,000.00">
    </div>

    <label>Tasa de inter√©s anual (%)</label>
    <input type="number" id="tasa" placeholder="Ej. 10">

    <label>A√±os a invertir</label>
    <input type="number" id="a√±os" placeholder="Ej. 20">

    <label>Frecuencia de capitalizaci√≥n</label>
    <select id="frecuencia">
        <option value="1">Anual</option>
        <option value="12">Mensual</option>
        <option value="52">Semanal</option>
    </select>

    <label>Inflaci√≥n anual (%)</label>
    <input type="text" inputmode="decimal" id="inflacion" placeholder="Ej. 6">

    <label>Meta financiera</label>
    <div class="input-money">
        <span>$</span>
        <input type="text" inputmode="decimal" id="meta" placeholder="1,000,000.00">
    </div>

    <button id="btnCalcular">Calcular</button>
    
    <h3 style="margin-top:30px;color:#d4af37;border-bottom:1px solid #d4af37;padding-bottom:6px;">üìä Resumen General</h3>
    <div class="resumen" id="resumen"></div>
    <h3 style="margin-top:35px;color:#d4af37;border-bottom:1px solid #d4af37;padding-bottom:6px;">üìà Resultados Finales</h3>
    <div id="cards" style="display:flex;gap:15px;margin-top:20px;flex-wrap:wrap;"></div>

    <canvas id="grafica"></canvas>

    <h3 style="margin-top:40px;color:#d4af37;border-bottom:1px solid #d4af37;padding-bottom:6px;">üìã Detalle por A√±o</h3>
    <div style="margin-top:20px;max-height:300px;overflow-y:auto;border:1px solid #d4af37;border-radius:12px;">
        <table id="tablaResultados" style="width:100%;border-collapse:collapse;font-size:13px;">
            <thead style="background:#000;color:#d4af37;position:sticky;top:0;">
                <tr>
                    <th style="padding:8px;border-bottom:1px solid #d4af37;">A√±o</th>
                    <th style="padding:8px;border-bottom:1px solid #d4af37;">Total Simple</th>
                    <th style="padding:8px;border-bottom:1px solid #d4af37;">Total Compuesto</th>
                </tr>
            </thead>
            <tbody style="text-align:center;background:#111;"></tbody>
        </table>
    </div>
</div>

<script>
let chart = null;

function formatoMoneda(valor){
    return "$" + Number(valor).toLocaleString('es-MX', {minimumFractionDigits:2, maximumFractionDigits:2});
}

function limpiarNumero(valor){
    return parseFloat(valor.replace(/,/g,'')) || 0;
}

function formatearInput(input){
    input.addEventListener('input', function(e){
        let valor = e.target.value.replace(/,/g,'');
        if(valor === '') return;
        if(!isNaN(valor)){
            const numero = parseFloat(valor);
            e.target.value = numero.toLocaleString('en-US', {maximumFractionDigits:2});
        }
    });
}

function calcular() {
    const capital = limpiarNumero(document.getElementById("capital").value);
    const aportacion = limpiarNumero(document.getElementById("aportacion").value);
    const tasaAnual = (parseFloat(document.getElementById("tasa").value) || 0) / 100;
    const a√±os = parseInt(document.getElementById("a√±os").value) || 0;
    const frecuencia = parseInt(document.getElementById("frecuencia").value);
    const inflacionAnual = limpiarNumero(document.getElementById("inflacion").value) / 100;
    const meta = limpiarNumero(document.getElementById("meta").value);

    if (capital <= 0 || tasaAnual <= 0 || a√±os <= 0) {
        alert("Completa capital, tasa y a√±os correctamente");
        return;
    }

    const periodos = a√±os * frecuencia;
    const tasaPeriodo = tasaAnual / frecuencia;

    let simple = capital;
    let compuesto = capital;

    const simpleData = [];
    const compuestoData = [];
    const labels = [];
    const tabla = [];

    for (let i = 0; i <= periodos; i++) {
        if (i > 0) {
            simple += capital * tasaPeriodo;
            simple += aportacion;

            compuesto = (compuesto + aportacion) * (1 + tasaPeriodo);
        }

        if (i % frecuencia === 0) {
            const a√±oActual = i / frecuencia;
            labels.push("A√±o " + a√±oActual);
            simpleData.push(simple);
            compuestoData.push(compuesto);
            tabla.push({
                a√±o: a√±oActual,
                simple: simple,
                compuesto: compuesto
            });
        }
    }

    const aportacionesTotales = aportacion * periodos;
    const invertidoTotal = capital + aportacionesTotales;
    const interesAcumulado = compuesto - invertidoTotal;
    const interesSimpleGanado = simple - invertidoTotal;
    const diferencia = compuesto - simple;

    let rendimientoReal = 0;
    if (inflacionAnual > 0) {
        rendimientoReal = ((1 + tasaAnual) / (1 + inflacionAnual)) - 1;
    }

    let a√±oSuperaAportaciones = null;
    let a√±oMetaAlcanzada = null;

    for (let i = 0; i < tabla.length; i++) {
        const aportadoHastaEseMomento = capital + (aportacion * (tabla[i].a√±o * frecuencia));
        const interesHastaEseMomento = tabla[i].compuesto - aportadoHastaEseMomento;

        if (a√±oSuperaAportaciones === null && interesHastaEseMomento > (aportacion * (tabla[i].a√±o * frecuencia))) {
            a√±oSuperaAportaciones = tabla[i].a√±o;
        }

        if (meta > 0 && a√±oMetaAlcanzada === null && tabla[i].compuesto >= meta) {
            a√±oMetaAlcanzada = tabla[i].a√±o;
        }
    }

    document.getElementById("resumen").innerHTML = `
        <div style="display:flex;gap:15px;flex-wrap:wrap;">
            <div style="flex:1;background:#000;padding:15px;border-radius:12px;border:1px solid #d4af37;text-align:center;min-width:200px;">
                <div>Total invertido</div>
                <h3>${formatoMoneda(invertidoTotal)}</h3>
            </div>
            <div style="flex:1;background:#000;padding:15px;border-radius:12px;border:1px solid #00bcd4;text-align:center;min-width:200px;">
                <div>Inter√©s ganado (Simple)</div>
                <h3>${formatoMoneda(interesSimpleGanado)}</h3>
            </div>
            <div style="flex:1;background:#000;padding:15px;border-radius:12px;border:1px solid #ff6b35;text-align:center;min-width:200px;">
                <div>Inter√©s ganado (Compuesto)</div>
                <h3>${formatoMoneda(interesAcumulado)}</h3>
            </div>
            <div style="flex:1;background:#000;padding:15px;border-radius:12px;border:1px solid #d4af37;text-align:center;min-width:200px;">
                <div>Diferencia a favor del compuesto</div>
                <h3>${formatoMoneda(diferencia)}</h3>
            </div>
            ${inflacionAnual > 0 ? `
            <div style="flex:1;background:#000;padding:15px;border-radius:12px;border:1px solid #888;text-align:center;min-width:200px;">
                <div>Rendimiento real anual</div>
                <h3>${(rendimientoReal*100).toFixed(2)}%</h3>
            </div>` : ``}
            ${a√±oSuperaAportaciones !== null ? `
            <div style="flex:1;background:#000;padding:15px;border-radius:12px;border:1px solid #00bcd4;text-align:center;min-width:200px;">
                <div>El inter√©s supera aportaciones</div>
                <h3>A√±o ${a√±oSuperaAportaciones}</h3>
            </div>` : ``}
            ${meta > 0 ? `
            <div style="flex:1;background:#000;padding:15px;border-radius:12px;border:1px solid #ff6b35;text-align:center;min-width:200px;">
                <div>Meta financiera</div>
                <h3>${a√±oMetaAlcanzada !== null ? 'A√±o ' + a√±oMetaAlcanzada : 'No alcanzada'}</h3>
            </div>` : ``}
        </div>
    `;

    const porcentajeCapital = (capital / compuesto) * 100;
    const porcentajeAportaciones = (aportacionesTotales / compuesto) * 100;
    const porcentajeInteres = (interesAcumulado / compuesto) * 100;

    document.getElementById("cards").innerHTML = `
        <div style="flex:1;background:#000;padding:15px;border-radius:12px;border:1px solid #d4af37;text-align:center;">
            <div>Aportaciones peri√≥dicas acumuladas</div>
            <h3>${formatoMoneda(aportacionesTotales)}</h3>
        </div>
        <div style="flex:1;background:#000;padding:15px;border-radius:12px;border:1px solid #00bcd4;text-align:center;">
            <div>Total final inter√©s simple</div>
            <h3>${formatoMoneda(simple)}</h3>
        </div>
        <div style="flex:1;background:#000;padding:15px;border-radius:12px;border:1px solid #ff6b35;text-align:center;">
            <div>Total final inter√©s compuesto</div>
            <h3>${formatoMoneda(compuesto)}</h3>
        </div>
        <div style="flex-basis:100%;background:#000;padding:15px;border-radius:12px;border:1px solid #d4af37;margin-top:10px;">
            <div style="margin-bottom:8px;text-align:center;">Composici√≥n del total final (Compuesto)</div>
            <div style="height:22px;background:#111;border-radius:10px;overflow:hidden;display:flex;cursor:pointer;">
                <div title="Capital: ${formatoMoneda(capital)}" style="width:${porcentajeCapital}%;background:#d4af37;"></div>
                <div title="Aportaciones: ${formatoMoneda(aportacionesTotales)}" style="width:${porcentajeAportaciones}%;background:#00bcd4;"></div>
                <div title="Inter√©s: ${formatoMoneda(interesAcumulado)}" style="width:${porcentajeInteres}%;background:#ff6b35;"></div>
            </div>
            <div style="display:flex;justify-content:space-around;font-size:12px;margin-top:8px;align-items:center;">
                <span style="display:flex;align-items:center;gap:6px;">
                    <span style="width:12px;height:12px;background:#d4af37;border-radius:3px;display:inline-block;"></span>
                    Capital
                </span>
                <span style="display:flex;align-items:center;gap:6px;">
                    <span style="width:12px;height:12px;background:#00bcd4;border-radius:3px;display:inline-block;"></span>
                    Aportaciones
                </span>
                <span style="display:flex;align-items:center;gap:6px;">
                    <span style="width:12px;height:12px;background:#ff6b35;border-radius:3px;display:inline-block;"></span>
                    Inter√©s
                </span>
            </div>
        </div>
        </div>
    `;

    const tbody = document.querySelector('#tablaResultados tbody');
    tbody.innerHTML = '';
    tabla.forEach(fila => {
        tbody.innerHTML += `
            <tr>
                <td style="padding:6px;border-bottom:1px solid #222;">${fila.a√±o}</td>
                <td style="padding:6px;border-bottom:1px solid #222;color:#00bcd4;">${formatoMoneda(fila.simple)}</td>
                <td style="padding:6px;border-bottom:1px solid #222;color:#ff6b35;">${formatoMoneda(fila.compuesto)}</td>
            </tr>
        `;
    });

    if (chart) chart.destroy();

    const ctx = document.getElementById("grafica").getContext("2d");
    chart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: labels,
            datasets: [
                {
                    label: 'Inter√©s Simple ($)',
                    data: simpleData,
                    borderColor: '#00bcd4',
                    borderWidth: 3,
                    tension: 0.3
                },
                {
                    label: 'Inter√©s Compuesto ($)',
                    data: compuestoData,
                    borderColor: '#ff6b35',
                    borderWidth: 4,
                    tension: 0.3
                }
            ]
        },
        options: {
            responsive: true,
            scales: {
                y: {
                    ticks: {
                        callback: value => '$' + value.toLocaleString()
                    }
                }
            }
        }
    });
}

window.addEventListener('DOMContentLoaded', function() {
    document.getElementById('btnCalcular').addEventListener('click', calcular);

    formatearInput(document.getElementById('capital'));
    formatearInput(document.getElementById('aportacion'));
    formatearInput(document.getElementById('inflacion'));
    formatearInput(document.getElementById('meta'));
});
</script>

</body>
</html>
